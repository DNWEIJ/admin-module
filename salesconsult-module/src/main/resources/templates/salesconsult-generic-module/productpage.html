<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/layout.html}">
<head>
    <title th:if="${salesType.isPriceInfo}" th:text="#{label.title.priceinfo}"></title>
    <title th:if="${salesType.isOtc}" th:text="#{label.title.otc}"></title>
    <title th:if="${salesType.isEstimate}" th:text="#{label.title.estimate}"></title>
</head>
<body>

<section layout:fragment="content">
    <h3 th:if="${salesType.isOtc}" th:text="#{label.title.otc}"></h3>
    <h3 th:if="${salesType.isPriceInfo}" th:text="#{label.title.priceinfo}"></h3>
    <h3 th:if="${salesType.isVisit}" th:text="#{label.title.visit}"></h3>
    <h3 th:if="${salesType.isEstimate}" th:text="#{label.title.estimate}"></h3>
    <div th:if="${thymeleafDebug != null}">
        <div th:text="${appointment.id} + ' - ' + ${selectedPet.name}"></div>
    </div>

    <block th:if="${!salesType.isPriceInfo}">
        <fieldset role="group" class="grid">
            <th:block th:insert="~{sales-module/fragments/customerpetinfo::customerPetInfo(${customer}, ${selectedPet}, false)}"></th:block>
        </fieldset>
        <fieldset class="grid">
            <th:block th:with="extras=~{sales-module/fragments/extrabuttons::historySoapNoteButtons}">
                <th:block th:insert="~{sales-module/fragments/petdropdownandbuttons::petDropDownAndButtons(${petsOnAppointment}, ${selectedPet}, ${customer}, ${visit}, ${appointment}, ${extras}, false)}"></th:block>
            </th:block>
        </fieldset>
        <hr/>
    </block>

    <details id="lineitems" open>
        <summary class="three-elements">
            <a href="" th:title="#{visit.lineitems.history}" th:hx-get="${'/consult/visit/customer/'+ customerId + '/pet/'  + petId + '/history/product'}" hx-target="#modal-container"
               hx-swap="innerHTML">Ô∏èüõí</a>
            <span class="center-text" th:text="#{label.otc.legend.lineitems}"></span>
            <a href="/info/lineiteminfo" title="More info" class="info-icon">‚ÑπÔ∏è</a>
        </summary>
        <th:include th:replace="~{sales-module/fragments/htmx/lineitemsfulltable}"></th:include>
        <!-- TODO: Check on visit isOpen -->
        <div id="replacePartForCostingSearch" th:if="${!(appointment.isCancelled || appointment.isCompleted)}"
             th:insert="~{supplies-module/fragments/costing/costingSearch::costingSearch(true)}">
        </div>
    </details>
</section>
</body>
</html>