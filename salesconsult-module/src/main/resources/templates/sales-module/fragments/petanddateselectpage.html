<th:block th:replace="~{salesconsult-generic-module/jsforpetselect}"></th:block>
<div class="overflow-auto">
    <fieldset role="group" class="grid">
        <th:block
                th:insert="~{sales-module/fragments/customerpetinfo::customerPetInfo(${customer}, ${selectedPet}, false)}"></th:block>
    </fieldset>
    <th:block th:with="formAction=${salesType.isOtc ? '/sales/otc/search/' + customer.id : salesType.isVisit ? '/consult/visit/search/' + customer.id + '?callFrom=customer' : salesType.isEstimate ? '/consult/customer/' + customer.id + '/estimate' : null }">
        <th:block th:unless="${isHtmx}">
            <form id="createForm" method="post" th:action="${formAction}">
        </th:block>
        <th:block th:if="${isHtmx}">
            <form id="createForm" method="post" th:hx-post="${formAction}" hx-on::after-request="agendaState.handleReturnModalSubmitForPetSelect(event)">
        </th:block>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <th:block th:if="${salesType.isVisit}">
            <th:block th:insert="~{consult-module/fragments/datetimelocation::dateTimeLocationSelect()}"></th:block>
        </th:block>
        <th:block th:insert="~{salesconsult-generic-module/petselect::petSelect(${customer}, ${pets}, ${deceasedPets}, ${salesType}, true)}"></th:block>
        <fieldset class="grid">
            <div th:if="${salesType.isVisit}">
                <input type="button" th:value="#{label.otc.sell.add.pet}"
                       th:hx-get="'/customer/customer/'+ ${customer.id} + '/pet'"
                       hx-target="#modal-container" hx-swap="innerHTML"
                       hx-on::after-request="addEventListenersForPetSelect()"/>
            </div>
            <div>
                <input type="submit" name="_save" form="createForm" th:value="#{label.button.next}"/>
            </div>
        </fieldset>
        </form>
    </th:block>
</div>